---
import PageLayout from "@/layouts/Base.astro";
import { getCollection, type CollectionEntry } from "astro:content";

type ProjectEntry = CollectionEntry<"projects">;

export async function getStaticPaths() {
  const projects = await getCollection("projects");
  return projects.map((p) => ({
    params: { slug: p.slug },
    props: { project: p },
  }));
}

const { project } = Astro.props as { project: ProjectEntry };
const { Content } = await project.render();
const { description, timeline, github, title } = project.data;
---

<PageLayout meta={{ title: project.data.title }}>
  <article>
    <!-- No custom header here; markdown is the page -->

    <div class="prose">
      <Content />
    </div>

    <footer class="project-footer">
      <div class="project-footer-grid">
        <div>
          <div class="label">Description</div>
          <div class="value">{description}</div>
        </div>

        <div>
          <div class="label">Timeline</div>
          <div class="value">{timeline}</div>
        </div>
      </div>

      {github && (
        <div class="project-footer-actions">
          <a class="btn" href={github} target="_blank" rel="noreferrer">View GitHub repo</a>
        </div>
      )}
    </footer>
  </article>

  <style>
    .project-footer { margin-top: 3rem; padding-top: 1.25rem; border-top: 1px solid rgba(255,255,255,0.08); }
    .project-footer-grid { display: grid; grid-template-columns: 1fr; gap: 1rem; }
    @media (min-width: 640px) { .project-footer-grid { grid-template-columns: 1fr 1fr; } }
    .label { font-size: 0.85rem; opacity: 0.7; margin-bottom: 0.35rem; }
    .value { font-size: 0.95rem; line-height: 1.6; }
    .project-footer-actions { margin-top: 1.25rem; }
  </style>
</PageLayout>